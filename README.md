# Создание и настройка стенда на GNS3 для проведения лабораторных работ по сетевой безопасности

### Введение

В современном мире сетевая безопасность стала одним из ключевых аспектов в области информационных технологий. Для практического освоения принципов защиты сетей и систем, создание и настройка виртуального стенда являются важным этапом в обучении специалистов по сетевой безопасности. В этой статье мы рассмотрим шаги по созданию и настройке стенда на GNS3, популярной платформе для моделирования сетей, с целью проведения простых лабораторных работ по сетевой безопасности.

### Что такое GNS3?

**GNS3** (Graphical Network Simulator-3) — это программное обеспечение с открытым исходным кодом, которое моделирует сложные сети, максимально приближаясь к тому, как работают реальные сети. И все это без специального сетевого оборудования, такого как маршрутизаторы и коммутаторы.

#### **Архитектура**

GNS3 состоит из двух частей:

1.  Клиентская часть (GNS3-all-in-one)

    Представляет из себя графический интерфейс (GUI) в котором создаются топологии.
2.  Серверная часть

    Это ПО, на котором запускается эмуляция работы устройств из вашей топологии. Это может быть встроенный в клиентскую часть сервер, локальная или удаленная виртуальная машина.

В качестве серверной части рекомендуется использовать виртуальные машины, которые представлены для разных платформ (VMware, Virtualbox и т.д.). GNS3 может быть использован и без серверной части, но это сильно ограничивает его функции.

GNS3 поддерживает как эмуляцию, так и симуляцию устройств:

* **Эмуляция**: GNS3 имитирует или эмулирует аппаратное обеспечение устройства, и вы запускаете реальные ОС на виртуальном устройстве. Например, вы можете скопировать Cisco IOS с реального физического маршрутизатора Cisco и запустить его на виртуальном эмулируемом маршрутизаторе Cisco в GNS3.
* **Симуляция**: GNS3 имитирует функции и возможности такого устройства, как коммутатор. Вы используете не настоящие ОС (например, Cisco IOS), а скорее симулированное устройство, разработанное GNS3, например встроенный коммутатор L2.

### Установка GNS3

Первым делом требуется установить клиентскую часть GNS3 на вашем ПК. Последние версии под разные ОС находятся по [ссылке](https://www.gns3.com/software/download).

Инструкции по установке доступны в официальной документации: [Windows](https://docs.gns3.com/docs/getting-started/installation/windows), [Linux](https://docs.gns3.com/docs/getting-started/installation/linux), [Mac](https://docs.gns3.com/docs/getting-started/installation/mac).

Также нам понадобится установить [виртуальную машину GNS3](https://docs.gns3.com/docs/getting-started/installation/download-gns3-vm).

При написании этой статьи использовалась клиентская часть версии 2.2.45 и виртуальная машина для VMware Workstation с такой же версией. В качестве хостовой системы используется EndeavourOS (основан на Arch Linux).

### Настройка GNS3

При первом запуске откроется Мастер настройки.

<figure><img src=".gitbook/assets/setup_wizard (1).png" alt=""><figcaption><p>Мастер настройки</p></figcaption></figure>

Выбираем 1 пункт "Run appliances in a virtual machine", так как мы будем использовать виртуальную машину для эмуляции устройств и нажимаем Next. Откроется окно настройки локального сервера.

<figure><img src=".gitbook/assets/local_server (1).png" alt=""><figcaption><p>Настройки локального сервера</p></figcaption></figure>

Здесь меняем Host binding на сеть VMware Host-only, так как GNS требует, чтобы локальный сервер работал в той же сети, что и виртуальная машина. Порт можно выбрать любой. В Linux-based системах лучше выбирать порт выше 1024, так как они не требуют для запуска root-прав. Нажимаем Next. Начнётся проверка локального сервера.

<figure><img src=".gitbook/assets/local_server_ok (1).png" alt=""><figcaption><p>Проверка подключения к локальному серверу</p></figcaption></figure>

Если вы всё правильно установили, то GNS3 напишет, что подключение прошло успешно. Нажимаем Next. Откроется окно настройки виртуальной машины.

<figure><img src=".gitbook/assets/vm (1).png" alt=""><figcaption><p>Настройки виртуальной машины</p></figcaption></figure>

Здесь выбираем VMware. Если вы уже импортировали GNS3 VM, то она отобразится в списке, если же вы этого ещё не сделали, то самое время скачать и импортировать её в VMware и после нажать Refresh. Вы можете установить любое число виртуальных ядер и памяти, для примера установлено 4 ядра и 16 Гб оперативной памяти. Нажимаем Next. Откроется окно подтверждения.

<figure><img src=".gitbook/assets/vm_summary (1).png" alt=""><figcaption><p>Подтверждение настроек виртуальной машины</p></figcaption></figure>

Проверьте настройки и нажимайте Finish. Если вы сделали всё правильно, то в VMware должна была запустится виртуальная машина.

<figure><img src=".gitbook/assets/vmware (1).png" alt=""><figcaption><p>Окно VMware</p></figcaption></figure>

### Главное окно GNS3

После настройки GNS3 должно открыться окно создания проекта. Если вы его случайно закрыли, или по какой-то причине оно не открылось, то его можно открыть вручную: File -> New Blank Project.

<figure><img src=".gitbook/assets/new_project (1).png" alt=""><figcaption><p>Создание нового проекта GNS3</p></figcaption></figure>

Можете назвать свой проект как угодно. Я назову его sample\_project. После нажмите OK. Теперь доступно главное окно GNS3.

<figure><img src=".gitbook/assets/main_window.png" alt=""><figcaption><p>Главное окно GNS3</p></figcaption></figure>

Окно содержит множество элементов, рассмотрим каждое из них.

#### **Рабочее пространство**

Рабочее пространство это окно, в котором создаются топологии.

<figure><img src=".gitbook/assets/workspace.png" alt=""><figcaption><p>Рабочее простанство</p></figcaption></figure>

#### **Панель инструментов**

Здесь представлены кнопки для быстрого доступа к инструментам.

<figure><img src=".gitbook/assets/toolbar.png" alt=""><figcaption><p>Панель инструментов</p></figcaption></figure>

#### **Панель устройств**

Здесь представлены все устройства, которые могут быть в вашей топологии.

<figure><img src=".gitbook/assets/device_toolbar.png" alt=""><figcaption><p>Панель устройств</p></figcaption></figure>

Устройства сгруппированы в следующие группы:

<table><thead><tr><th width="100">Кнопка</th><th>Название</th></tr></thead><tbody><tr><td><img src=".gitbook/assets/routers.png" alt=""></td><td>Роутеры</td></tr><tr><td><img src=".gitbook/assets/switches (1).png" alt=""></td><td>Коммутаторы и хабы</td></tr><tr><td><img src=".gitbook/assets/end_devices.png" alt=""></td><td>Конечные устройства (ПК, Облако и т.д.)</td></tr><tr><td><img src=".gitbook/assets/security_devices.png" alt=""></td><td>Устройства безопасности</td></tr><tr><td><img src=".gitbook/assets/all_devices.png" alt=""></td><td>Все устройства</td></tr><tr><td><img src=".gitbook/assets/add_link.png" alt=""></td><td>Добавить соединение</td></tr></tbody></table>

#### **Информация о топологии**

Здесь указаны все устройства в сети и их состояние (включено/выключено).

<figure><img src=".gitbook/assets/topology_summary.png" alt=""><figcaption><p>Информация о топологии</p></figcaption></figure>

#### **Информация о серверах**

Если при установке и настройке вы сделали всё правильно, то в окне Servers Summary должны отображаться два сервера: локальный (на скриншоте arslan-laptop) и виртуальная машина (на скриншоте GNS3 VM). Также здесь отображается нагруженность серверов и какие устройства на них работают.

<figure><img src=".gitbook/assets/servers_summary.png" alt=""><figcaption><p>Информация о серверах</p></figcaption></figure>

### Создание первой топологии

Создадим простую топологию:

* Три компьютера
* Один коммутатор

Компьютеры будут иметь статические IP-адреса, чтобы не требовался DHCP-сервер в сети.

Первым делом создадим три компьютера. Откроем группу End Devices в панели устройств и перетащим VPCS (Virtual PC Simulator) в рабочую зону.

<figure><img src=".gitbook/assets/vpcs.png" alt=""><figcaption><p>Группа End Devices</p></figcaption></figure>

При добавлении устройства нам предлагают выбор сервера. Выбираем виртуальную машину.

<figure><img src=".gitbook/assets/server_choice.png" alt=""><figcaption><p>Выбор сервера</p></figcaption></figure>

После добавления всех компьютеров, рабочая область должна выглядеть примерно так:

<figure><img src=".gitbook/assets/vpcs_added.png" alt=""><figcaption><p>Топология с компьютерами</p></figcaption></figure>

Добавим в топологию Ethernet Switch из группы Switches:

<figure><img src=".gitbook/assets/switches.png" alt=""><figcaption><p>Группа Switches</p></figcaption></figure>

Так же, как и при добавлении сервера, выбираем в качестве сервера нашу виртуальную машину. Сейчас рабочая область выглядит вот так:

<figure><img src=".gitbook/assets/switch_added.png" alt=""><figcaption><p>Топология с добавленным коммутатором</p></figcaption></figure>

Теперь нам нужно добавить соединения между устройствами. В панели устройств выбираем Add a Link и нажимаем на PC1. Появится выбор порта. В случае с VPCS нам доступен только один порт.

<figure><img src=".gitbook/assets/port_choice.png" alt=""><figcaption><p>Выбор порта у PC1</p></figcaption></figure>

Соединяем его со Switch1. Нажимаем на Switch1 и выбираем порт Ethernet0.

<figure><img src=".gitbook/assets/port_choice_switch.png" alt=""><figcaption><p>Выбор порта у Switch1</p></figcaption></figure>

Мы успешно создали первую связь. Необходимо проделать то же самое с другими ПК. Должно получится следующим образом:

<figure><img src=".gitbook/assets/topology_ready_offline.png" alt=""><figcaption><p>Топология со связями</p></figcaption></figure>

Обратите внимание на цвета у связей. В таблице приведены все возможные цвета:

| Цвет    | Состояние                 |
| ------- | ------------------------- |
| Красный | Устройство выключено      |
| Жёлтый  | Устройство приостановлено |
| Зелёный | Устройство включено       |

{% hint style="warning" %}
**Примечание:** Если устройство помечено зелёным, то это ещё не значит, что порт находится в рабочем состоянии (он может быть выключен программно). Рекомендуется перепроверять, что порт включен через конфигурацию.
{% endhint %}

Запустим все устройства в топологии. Для этого нажмём кнопку Play в панели инструментов.

<figure><img src=".gitbook/assets/play_topology.png" alt=""><figcaption><p>Запуск топологии</p></figcaption></figure>

Все ПК в топологии стали активными, что видно по цвету связей и в информации о топологии.

<figure><img src=".gitbook/assets/topology_ready_online.png" alt=""><figcaption><p>Запущенная топология</p></figcaption></figure>

VPCS представляет собой очень упрощенное устройство, поэтому управлять им можно только через командную консоль.

<figure><img src=".gitbook/assets/vpcs_console.png" alt=""><figcaption><p>Консоль VPCS</p></figcaption></figure>

Пусть все наши ПК находятся в одной сети 10.10.10.0/24. Назначим IP-адреса следующим образом

| Компьютер | IP-адрес   |
| --------- | ---------- |
| PC1       | 10.10.10.1 |
| PC2       | 10.10.10.2 |
| PC3       | 10.10.10.3 |

В VPCS адреса назначаются через команду ip:

<figure><img src=".gitbook/assets/pc1_ip_set.png" alt=""><figcaption><p>Установка IP-адреса у PC1</p></figcaption></figure>

Проделаем это для остальных ПК в топологии:

<figure><img src=".gitbook/assets/pc2_ip_set.png" alt=""><figcaption><p>Установка IP-адреса у PC2</p></figcaption></figure>

<figure><img src=".gitbook/assets/pc3_ip_set.png" alt=""><figcaption><p>Установка IP-адреса у PC3</p></figcaption></figure>

Проверим, что все ПК видят друг друга через команду ping:

<figure><img src=".gitbook/assets/pc1_ping.png" alt=""><figcaption><p>Команды ping на PC1</p></figcaption></figure>

<figure><img src=".gitbook/assets/pc2_ping.png" alt=""><figcaption><p>Команды ping на PC2</p></figcaption></figure>

<figure><img src=".gitbook/assets/pc3_ping.png" alt=""><figcaption><p>Команды ping на PC3</p></figcaption></figure>

Если все пинги прошли успешно, то поздравляю, вы успешно создали **свою первую топологию** в GNS3!

### А что дальше?

На самом деле, с помощью стандартных устройств GNS3 нужные топологии не сделать. Есть [специальный сайт](https://gns3.com/marketplace/featured), где представлено множество устройств, преднастроенных проектов и ПО. Установка выходит за рамки статьи, но есть [туториал](https://docs.gns3.com/docs/using-gns3/beginners/import-gns3-appliance/).

Ещё рекомендую вам самим изучить [документацию к GNS3](https://docs.gns3.com/docs/), так как она содержит много полезных вещей, которые были опущены в статье.

### Заключение

В этой статье мы разобрали, как установить GNS3 с виртуальной машиной, как их настроить и как сделать свою первую топологию. Надеюсь, что она вам пригодится в рамках выполнения лабораторных работ по сетевой безопасности.
